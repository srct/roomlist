{% extends 'layouts/base.html' %}

{% block title %} SRCT Roomlist &bull; My Settings {% endblock %}

{% block css %}
<link href="/static/css/chosen.min.css" rel="stylesheet" media="screen">
{% endblock css %}

{% block message_queue %}
{% endblock %}

{% block content %}
{% load cache %}
{% cache 4 student_update request.user.username %}

{% include 'room_change_warning.html' %}

{% include 'messages.html' %}

{% load accounts_extras %}

<div class="page-header" id="banner">
  <div class="row">
    <div class="col-md-12 text-center">
      <h1><strong>My Settings</strong></h1>
    </div>
  </div>
</div>

<div class="row">

  <div class="col-md-8">

    <div class="panel panel-default">
      <div class="panel-heading">
        <h1 class="panel-title text-center"><strong>Profile Settings</strong></h1>
      </div>
      <div class="panel-body">
        <p class="small">
          <i class="fa fa-fw fa-info-circle"></i>
          Unfortunately we do not support uploading images for your profile picture.
          Connect your Facebook account, or add your
          <a href="http://masonlive.gmu.edu/">@masonlive.gmu.edu</a>
          email address to <a href="https://en.gravatar.com/">Gravatar</a>.
        </p>
        <hr />
        {% if my_form.non_field_errors %}
        <ul class="text-center">
          {% for error in form.non_field_errors %}
            <li class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</li>
          {% endfor %}
        </ul>
        <hr />
        {% endif %}
        {% spaceless %}
        <form class="form-horizontal" autocomplete="off" action="" method="post">{% csrf_token %}
          <fieldset>
          {% if form.first_name.errors %}
            {% for error in form.first_name.errors %}
              <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
            {% endfor %}
          {% endif %}
          {% if form.last_name.errors %}
            {% for error in form.last_name.errors %}
              <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
            {% endfor %}
          {% endif %}
          <div class="form-group">
            <label for="{{ my_form.first_name.id_for_label }}" class="col-md-2">First Name</label>
              <div class="col-md-4">
                {% if not my_form.first_name.errors %}
                  {{ my_form.first_name }}
                {% else %}
                  <div class="has-error">
                    {{ my_form.first_name }}
                    <p>{{ form.first_name.errors }}</p>
                  </div>
                {% endif %}
              </div>
            <label for="{{ my_form.last_name.id_for_label }}" class="col-md-2">Last Name</label>
              <div class="col-md-4">
                {% if not my_form.last_name.errors %}
                  {{ my_form.last_name }}
                {% else %}
                  <div class="has-error">
                    {{ my_form.last_name }}
                    <p>{{ form.last_name.errors }}</p>
                  </div>
                {% endif %}
              </div>
          </div>
          {% if form.gender.errors %}
            {% for error in form.gender.errors %}
              <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
            {% endfor %}
          {% endif %}
          <div class="form-group">
            <label for="{{ my_form.gender.id_for_label }}" class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
              Gender Identity
              <p class="help-block">(choose all that apply)</p>
            </label>
              {% for checkbox in my_form.gender %}
                <div class="checkbox col-lg-2 col-md-3 col-sm-3 col-sm-offset-1 col-xs-5 col-xs-offset-1">
                  <label for="{{ checkbox.id_for_label }}">
                    {{ checkbox.choice_label|gender_icon }}
                    {{ checkbox.tag }}
                  </label>
                </div>
              {% endfor %}
          </div>
          {% if form.show_gender.errors %}
            {% for error in form.show_gender.errors %}
              <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
            {% endfor %}
          {% endif %}
          <div class="form-group">
            <label for="{{ my_form.show_gender.id_for_label }}" class="col-md-3 col-sm-4 col-xs-5">
              Show Gender on Profile?
            </label>
              {% for option in my_form.show_gender %}
                <label class="radio-inline">{{ option.choice_label }}{{ option.tag }}</label>
              {% endfor %}
          </div>
          {% if form.major.errors %}
            {% for error in form.major.errors %}
              <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
            {% endfor %}
          {% endif %}
          <hr />
          <div class="form-group">
            <label for="{{ my_form.major.id_for_label }}" class="col-md-2">
              Major(s)
            </label>
            <div class="col-md-4">
              {{ my_form.major }}
            </div>
          </div>
          {% if form.graduating_year.errors %}
            {% for error in form.graduating_year.errors %}
              <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
            {% endfor %}
          {% endif %}
          <div class="form-group">
            <label for="{{ my_form.graduating_year.id_for_label }}" class="col-md-2 col-sm-12 col-xs-12">
              Graduating Year
            </label>
              <div class="col-md-2 col-sm-3 col-xs-3">
                {{ my_form.graduating_year }}
              </div>
          </div>
          {% if not request.user.student.recent_changes > 2 %}
          <hr />
          {% if form.on_campus.errors %}
            {% for error in form.on_campus.errors %}
              <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
            {% endfor %}
          {% endif %}
          {% if request.user.student.is_staff %}
          <p class="help-block">Contact us if you are no longer a Resident Advisor or Director at
          <a href="mailto:roomlist@lists.srct.gmu.edu">roomlist@lists.srct.gmu.edu</a>.</p>
          {% endif %}
          <div class="form-group">
            <label for="{{ my_form.on_campus.id_for_label }}" class="col-md-3 col-sm-4 col-xs-5">
              Do You Live on Campus?
            </label>
              {% for option in my_form.on_campus %}
                <label class="radio-inline">{{ option.choice_label }}{{ option.tag }}</label>
              {% endfor %}
          </div>
          <div id="lives-on-campus">
            <hr />
            <p class="help-block">The Global Center, the Townhouses, and Beacon Hall are not currently supported.<br />
            We'll let everyone know when we add them.</p>
            {% if form.room.errors %}
              {% for error in form.room.errors %}
                <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
              {% endfor %}
            {% endif %}
            <div class="form-group">
              <div class="col-md-12">
                {{ my_form.room }}
              </div>
            </div>
            {% if form.privacy.errors %}
              {% for error in form.privacy.errors %}
                <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
              {% endfor %}
            {% endif %}
            <div class="form-group">
              <label for="{{ my_form.privacy.id_for_label }}" class="col-md-2">
                Privacy
              </label>
                {{ my_form.privacy }}
            </div>
          </div>
          <hr />
            <p class="help-block">
              You will not be able to see these students, and they will not be able to see you.
            </p>
            {% if form.blocked_kids.errors %}
              {% for error in form.blocked_kids.errors %}
                <p class="text-danger"><i class="fa fa-exclamation-triangle fa-fw"></i> {{ error }}</p>
              {% endfor %}
            {% endif %}
          <div class="form-group">
            <label for="{{ my_form.blocked_kids.id_for_label }}" class="col-md-2">
              Blocked Students
            </label>
            <div class="col-md-10">
              {{ my_form.blocked_kids }}
            </div>
          </div>
          {% endif %}
          <hr />
          <input type="submit" value="Save" class="btn btn-primary"/>
        </fieldset>
        </form>
        {% endspaceless %}
      </div>
    </div>
    <p>
      <small><a href="{% url 'delete_student' request.user.username %}">Delete Account</a></small>
    </p>
  </div>

{% include 'social/social_media_settings.html' %}

</div>

{% endcache %}
{% endblock content %}

{% block javascript %}
<script type="text/javascript" src="/static/js/chained.min.js"></script>
<script type="text/javascript" src="/static/js/chosen.min.js"></script>
<script>
$(".chosen-select").chosen({max_selected_options: 2,
                           placeholder_text_multiple: '(select up to two)'});
$(".blocked-select").chosen({width: "100%",
                             placeholder_text_multiple: "(search by name)"});
</script>
{% include 'room_selection_script.html' %}
{% endblock javascript %}
